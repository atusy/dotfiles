#!/bin/sh

set -euo pipefail

AGENTIC_SCRUM_REPOSITORY="github.com/atusy/agentic-scrum"
AGENTIC_SCRUM_ROOT="$HOME/ghq/$AGENTIC_SCRUM_REPOSITORY"
AGENTIC_SCRUM_PLUGIN="$AGENTIC_SCRUM_ROOT/claude-plugins/agentic-scrum"

if [ ! -d "$AGENTIC_SCRUM_ROOT" ]; then
  ghq get "$AGENTIC_SCRUM_REPOSITORY"
else
  git -C "$AGENTIC_SCRUM_PLUGIN" pull --ff-only origin HEAD &
fi

exec bunx @anthropic-ai/claude-code \
  --dangerously-skip-permissions \
  --plugin-dir "$AGENTIC_SCRUM_PLUGIN" \
  "$@"
